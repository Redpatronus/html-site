---
title: CVE-2025-24895
date: 2025-02-18 19:15:28
tags:
  - CVE-2025-24895
excludeSearch: false
width: wide
---

### Summary
CIE.AspNetCore.Authentication is an AspNetCore Remote Authenticator for CIE 3.0. Authentication using Spid and CIE is based on the SAML2 standard which provides two entities: 1. Identity Provider (IDP): the system that authenticates users and provides identity information (SAML affirmation) to the Service Provider, in essence, is responsible for the management of the credentials and identity of users; 2. Service Provider (SP): the system that provides a service to the user and relies on the Identity Provider to authenticate the user, receives SAML assertions from the IdP to grant access to resources. The library cie-aspnetcore refers to the second entity, the SP, and implements the validation logic of SAML assertions within SAML responses. In affected versions there is no guarantee that the first signature refers to the root object, it follows that if an attacker injects an item signed as the first element, all other signatures will not be verified. The only requirement is to have an XML element legitimately signed by the IdP, a condition that is easily met using the IdP's public metadata. An attacker could create an arbitrary SAML response that would be accepted by SPs using vulnerable SDKs, allowing him to impersonate any Spid and/or CIE user. This issue has been addressed in version 2.1.0 and all users are advised to upgrade. There are no known workarounds for this vulnerability.

#### Severity
- **Base Score**: 9.1
- **Exploitability Score**: 2.8
- **Impact Score**: 6.4
- **Exploitable**: Yes

### Details 
CVE-2025-24895 describes a critical security vulnerability in CIE.AspNetCore.Authentication, an AspNetCore Remote Authenticator for CIE 3.0. This vulnerability allows an attacker to bypass SAML signature verification, leading to potential user impersonation. The issue stems from the library's failure to ensure that the first signature in a SAML response refers to the root object. By injecting a signed XML element as the first element, an attacker can invalidate subsequent signature checks. Because only the first signature validation is considered, crafted responses are accepted. This can be done using IdPs public metadata which is easily accesible to the public.

### Remediation
The primary and recommended remediation for CVE-2025-24895 is to upgrade CIE.AspNetCore.Authentication to version 2.1.0 or later. This version contains a fix that properly validates SAML signatures and prevents the described impersonation attack.

**Steps to Remediate:**

1.  **Identify Affected Applications:** Determine all applications that utilize the vulnerable CIE.AspNetCore.Authentication library.
2.  **Upgrade the Package:** Upgrade the `CIE.AspNetCore.Authentication` NuGet package to version 2.1.0 or later in all affected projects.  This can typically be done through the NuGet Package Manager in Visual Studio or using the .NET CLI:
        dotnet add package CIE.AspNetCore.Authentication -v 2.1.0
    3.  **Rebuild and Redeploy:** Rebuild the applications after upgrading the package and redeploy them to all relevant environments (development, testing, production).
4.  **Verification:** After deployment, thoroughly test the SAML authentication flow to ensure that the vulnerability has been successfully mitigated and that authentication is working as expected.  Specifically, focus on validating that SAML responses are being correctly verified.
5.  **Monitoring:** Implement ongoing monitoring and logging of authentication attempts to detect any suspicious activity that might indicate exploitation attempts, even after applying the patch.

### Assigner
- **Name**: GitHub, Inc.
- **Email**: security-advisories@github.com

### Date
- **Published Date**: 2025-02-18 18:39:39
- **Updated Date**: 2025-02-18 19:15:28

### More Details
[CVE-2025-24895](https://www.cvedetails.com/cve/CVE-2025-24895)